!function(){function e(){var e=$(this),a=e.prop("action"),t=e.find('input[name="_method"]').val()||"POST",i=e.serialize();return $.ajax({type:t,url:a,data:i}).done(function(a){if("success"==a.response)switch(e.prop("class")){case"email-form":$(".center-alert").html(a.message).fadeIn(300).delay(2500).fadeOut(300),e.find("textarea").val("");break;case"response-email-form":$(".center-alert").html(a.message).fadeIn(300).delay(2500).fadeOut(300),$(".email-list").prepend('<li><div class="media"><div class="pull-left"><img class="media-object avatar small-avatar" src='+userProfileImage+" alt="+userFirstname+'></div><div class="media-body"><p><span class="text-muted">Just now you wrote:</span></p>'+feedBody+'</div></div><div class="email-body" style="display: block;">'+e.find("textarea").val()+"</div></li>"),e.find("textarea").val("");break;case"feed-form":{$(".feeds-count").text()}$(".feed-list").prepend('<div id="feedid" class="media listed-object"><div class="pull-left"><img class="media-object avatar medium-avatar" src="'+a.userProfileImage+'" alt="'+a.userFirstname+'"></div><div class="media-body"><h4 class="media-heading">'+a.userFirstname+"</h4><p>Just now</p>"+a.feedBody+"</div></div>"),e.find("textarea").val("")}else"failed"==a.response&&e.find("textarea").val("")}).fail(function(){return alert("something went wrong. Please try again.")}),!1}function a(){var e=$(this),a=e.attr("data-userid"),t=e.attr("href"),i=e.attr("data-method")||"POST",s=e.attr("class"),d=e.closest(".friend-request-media").find(".avatar").attr("src")||e.closest("#profile-card").find(".avatar").attr("src"),n=e.closest(".friend-request-media").find(".avatar").attr("alt")||e.closest("#profile-card").find(".avatar").attr("alt");return $.ajax({type:i,url:t,data:{userId:a}}).done(function(t){if("success"==t.response)switch(s){case"btn btn-primary friend-request-button btn-sm":e.attr("disabled","disabled").text("Request sent");break;case"btn btn-primary add-friend-button btn-sm":e.attr("disabled","disabled").text("Friend added"),$("#no-friend-chat-alert").hide(),$("#friend-list").append('<div id="friend-side-list" class="list-group"><a href="#" class="list-group-item side-list disabled" data-userid = "'+a+'"><div class="media"><div class="pull-left"><img class="media-object avatar small-avatar" src="'+d+'" alt="'+n+'"></div><div class="media-body">'+n+' <span class="glyphicon glyphicon-flash text-success"></span></div></div></a></div>');break;case"btn btn-primary add-friend-button-2 btn-sm":e.closest(".friend-request-media").slideUp(),$("#no-friend-chat-alert").hide(),$("#friend-list").append('<div id="friend-side-list" class="list-group"><a href="#" class="list-group-item side-list disabled" data-userid = "'+a+'"><div class="media"><div class="pull-left"><img class="media-object avatar small-avatar" src="'+d+'" alt="'+n+'"></div><div class="media-body">'+n+' <span class="glyphicon glyphicon-flash text-success"></span></div></div></a></div>'),0==t.count&&$(".friend-request-list").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friend requests.</div>');var i=$(".friends-count").text(),r=parseInt(i)+1;$(".friends-count").text(r);break;case"btn btn-primary unfriend-button btn-sm":e.attr("disabled","disabled").text("Removed"),0==t.count&&($("#friend-side-list").hide(),$("#friend-list").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friends.</div>'));var i=$(".friends-count").text(),r=parseInt(i)-1;$(".friends-count").text(r);break;case"btn btn-primary unfriend-button-2 btn-sm":e.closest(".friend-request-media").slideUp(),0==t.count&&$(".friend-request-list").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friend requests.</div>');break;case"btn btn-primary unfriend-button-3 btn-sm":e.closest(".friend-request-media").slideUp(),$("a[data-userid="+e.attr("data-userid")+"]").hide("slide",{direction:"right"},300),0==t.count&&($(".friend-request-list").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friends.</div>'),$("#friend-side-list").hide(),$("#friend-list").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friends.</div>'));var i=$(".friends-count").text(),r=parseInt(i)-1;$(".friends-count").text(r);break;case"logout-link":window.location.replace("#no-friend-chat-alert".length?"/":"/")}else"failed"==t.response?$(".center-alert").html(t.message).fadeIn(300).delay(2500).fadeOut(300):alert("Something went wrong. Please try again later.")}).fail(function(){return alert("something went wrong. Please try again.")}),!1}$(".welcome-alert").fadeIn(300).delay(3500).fadeOut(300),$(".feed-form").submit(e),$(".friend-request-button").click(a),$(".add-friend-button").click(a),$(".add-friend-button-2").click(a),$(".unfriend-button").click(a),$(".unfriend-button-2").click(a),$(".unfriend-button-3").click(a),$(".logout-link").click(a),"http://localhost:8000/feeds"==$(location).attr("href")&&$(window).scroll(function(){if($(window).scrollTop()+$(window).height()>=$(document).height()-850?$("#go-up").show():$("#go-up").hide(),$(window).scrollTop()+$(window).height()>=$(document).height()-300){var e=$(".listed-object").length;if(10>=e&&(e=10),!(e<$(".feed-list").attr("data-feedcount")))return!1;$("#loader").fadeIn("slow",function(){$.ajax({url:"feeds/more",data:{skipQty:e}}).done(function(e){$("#loader").fadeOut("slow",function(){var a="";$.each(e.feeds,function(e,t){return 0!=$("#feedid"+t.id).length?!1:void(a+='<div id="feedid'+t.id+'" class="media listed-object"><div class="pull-left"><img class="media-object avatar medium-avatar" src="'+t.poster_profile_image+'" alt="'+t.poster_firstname+'"></div><div class="media-body"><h4 class="media-heading">'+t.poster_firstname+"</h4><p>"+$.timeago(t.created_at)+"</p>"+t.body+"</div></div>")}),$(".feed-list").append(a)})}).fail(function(){return alert("something went wrong. Please try again.")})})}}),$("body").scrollspy({target:"#go-up"})}();